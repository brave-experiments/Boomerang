# Implementation of Broker's algorithm https://arxiv.org/pdf/0712.2022.pdf
# Code modified from https://pastebin.com/K0uA8qPB found in https://crypto.stackexchange.com/questions/89899/finding-an-elliptic-curve-of-specific-order
# Input: A prime N
# Output: A field F_t, and an elliptic curve E such that the order of E(F_t) is N.
from itertools import combinations
from timeit import default_timer as timer

import begin

# The characteristic of the base fields for each curve. E.g if E if a curve over F_p, then the value below is p.

# This is the 256-bit NIST Koblitz curve.
SECP256K1_FIELD_CHARACTERISTIC = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f

# This is also known as P-256
SECP256R1_FIELD_CHARACTERISTIC = 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff

# This is also known as P-384
SECP384R1_FIELD_CHARACTERISTIC = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff

# This is also known as P-521
SECP521R1_FIELD_CHARACTERISTIC = 0x01ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

# These are the 256-bit curve primes, used for benchmarking only.
curves_256 = [0xed6b5572d50f430bfcfcdd47b91036553c5cdec0238844717ed8af7441a2ffc9,
 0x948fb9ddeeda0a0d97fcf2c1a83fba43dc7cc42502206d01945341916c39eb5d,
 0x8e3af3d8bec8ae23cdd2e7e6485f1a7d4329d6f5cfa9677488a6eb22d3e8d6a9,
 0xd196f5b45ed939246edc24540a82b108530eb1a466978c8dba2d85f03af96a8b,
 0x8772de2290bfb6a83839aaeededd02e42a333a1a77ca51328463390d3c29c83d,
 0x9c85dc9cfdb23655a631d25bb94873ec90fb1205135fd560999378b3faaee72f,
 0x83f7fbe9e7bae833c7cf18e38cdbeb7d902c58a871da4522012c996d42210aa7,
 0xbd28ce3395cbeddd94b08229d469b66db0e1b3d55d7a580e86f9990e9949abff,
 0x8bd8a82b0e76f8383f6e8e3ab64f46bc78038911d4e922060c3bd5b2bdf1b1bd,
 0xe014120bc76e5765c0a74ce7765b1c4705296f549e85cdd73c9d48708d16e36d,
 0xda19c036df074beb067d332bc954d49494e58bef6dee29d7061c66ef8150664b,
 0xcfaf32db6d429a38e324e1a4f40bf792fe1b71be06b2cbe66715d3ee4f6146fd,
 0x9e026dea5c1073a37887ea4bcf71d716ac93f8dc063dcc144f1fa5cc947d60f7,
 0x9b6c570db47d773f9e373cc5623862d5f3efbc99aac3a4fadc54e1925afc3a5b,
 0x862d77ebaded0cac9ff4a19a9b7ee3caaa02ea855f079f6fc5f8938ca1bc9393,
 0x817acbf6d927d7acf0b3a9c015fee27b5cf35d2b34baafbf6d6f16f9a53c3585,
 0x877acd3d43ca966b62ed4001f0667bcf8d8c431a6717f2d9691468b83968b63f,
 0x84932c09a2dc06aa8300c1a379711d25533f2bd2d12f50792c4ddfc20f5011d3,
 0x89301aa2ac1b265ba92c45f643ff6d9adfe28f32bc4e5d6e31ffa956bd96582d,
 0x90e09ecf2015e39019659d26c5831eb4afe1877f09a8f88980b95bb0a422fef5,
 0x8cf46089fa1d7091bcb283953d675223bf4f45786e92569c5a6cfac1d847a733,
 0xd74e46e7765f7b60eb413693e1065ff3a453986d947b0b5122fdd2ad8d9b14c9,
 0xad7ca527ddc0a7289aa00d7f835e99db0505b130619eba6ddead41c937d82ad3,
 0x99d0a643912af140365bf00a7e09c5bbb32abbca8743ea78870af3e8e755f781,
 0xd1137eb403ad2db5007f764f8f7629769f36aacdb046b8efd521afb5f50c9f8d,
 0xfd97e196b32d08be83bba7e13cf1c37fca988b1a1db316d9b65cfd1d9276c853,
 0xa6e33c2a841b4684c7901a6e6b49b4078c49f3218568e65ba78f2dda4b7d191f,
 0xf5bf594b7a2e8bd1e7907dbfff5e101784f911eaa6df36b82830df52faac6823,
 0xad0f3adcf4899c328b0918b93edd24ae0f55554041b8dcce86b9442f77873707,
 0x93836e5a73686c0d7c51ebb62dabcffe268b410acad342987c03acc993d517c7,
 0xdb50bc9f566f95e5d621a6e97488a19a8a03c8ce0c28a8b2b01b4c0637009e01,
 0x90fd5025e7f52e6af4c0779d5188759d46f74df30e8d177b367f6d82c3420a69,
 0x92b9d106457ec48911df7d91303cd838cc59cbc34b3f9dc3b5e97b57e90b1085,
 0xce3fc01d8f8ed398e99e6f95d50a068d3309766c506e825d357f80822f99fae1,
 0xda2bbc89ac4a1f0b4e86b6219990e15a26db1c821e4b18329789d9d7e8acf2b9,
 0x85ac894532565d47a27dab1acd38ddb44885336f549e0eac455c03bee18ed3df,
 0xbfa361b4153054f12fc53972f0b7cbf5d88cadd22de89983954a3e13b7c81431,
 0xb18eb84e1f667632a25390c8af2f23301b26603f7dda19bdffdf45a2c9bf1171,
 0xa62d41e4ea0aa89eff9d49b8e955cc84c47260ba5f3ba442e6ce7ace0de34651,
 0xed7337f35607e82c12f806ee8d2d9fe80fe5e86a8d368823a957714b142c7749,
 0xfdf183f8cb677aca7d30ce8b89bc851c3f6ff97130bc3919ff5caf4ca0723e71,
 0xc96734bab7d10978bc8bd8cb64264bb3a274279176f3a0b2f778fc7e7de50ba1,
 0xc6aec4a43d58759cd9554178ccff39fe3bee42aeee1f36ff1a922fe4a8f989af,
 0xc44317568393e8e3e4216a968d7d387f4d4c0e398e6bb4c8b4cb38384526fa9d,
 0xeecc436e75aa604bf7b6d997db340ff064b0ae379ff258efa2900e7711a097a7,
 0xdc9b4c35689724c0f8c5a8538995a6702aa56a413259a24cfd20722c8d5216ad,
 0x9b46362c317ce4b2c15526a67beb94c2191bbc56a50c8a4edd25c22f7496dde3,
 0xdf52bc50c57d2f72606dbb63bdf1440d6830061c95a3333d16012ef15f6023cb,
 0xd6d26a0a6e9b26dab1052e03fbfc3faccfdab8b73ace7c6a0a326f8a9b89ea05,
 0xfdea37a07bcc1da40cce770c528d475c7142558bbb75756549a9481c3b6e178f,
 0xeb27b4cefe695849c7c0b0c7e6ee6337dec9c4342ea8535b3a11182303a09751,
 0xbf62ea6276786c8088211c49da8e142d3eed188eb1018daedcfcab066bb49323,
 0xc193dd1174307a1858b8f84edf1cc07d1408d4215e5497d161d3c8bc91a3eb43,
 0xc18bc3a50237800682414c07c0c262e30865cdeb3189ed5d31077417f7e0390b,
 0x88c78598c36c55d7e64bfc8dde7fc18d4faf2a2ffc1d6d4106d8129c55652e31,
 0xbbffe7c9ff64bd0a8ec01bdd7f104dd03b5ce4847744a6f86678cfd78ea20271,
 0xa0d2ccba843b93ad424d6074f7b01e69239dcffe859ee79dbc9dfbd09f056bfd,
 0xcaf1fe194ee42943e349b10c88909bfe77cbe57d4c831a3d46b54bbfd0b3b755,
 0xb9d028236dd34994748f0e38b572fa78a15fc93ceae273c7619d910ffaca0281,
 0xb092d3a66a136ab32bd2a123902a6d79a09ac0959980a57c1641853eecc00dd9,
 0xfcf135a54e37bda9dbca50ac4936501d97df607a5a9af6de913041f91217ae19,
 0xd0bc658b465f102e627580c4f73d971fc6064a5d536f9c171480cb6774dee7f5,
 0xf683793ef95d17deefb299776285a161d7451d16f107c3243b5e6c6a5c9426db,
 0x9ba72b61f16db98d517c352f9934c622f64974aff1146fd6f78e6500a4396979,
 0x86d2f20a624b6ca6b8263f6411a42b205844405097170307062c09a3347bfe05,
 0xf9b898290c68f4e3f5bb9d0b597efd3aba22f153e5ffa5d4863b4dfcd0c2ffcb,
 0x90d0a6aa7498740cc16221d4d355521ab4e32c7dd803fe14e144dc3aeb1f2aef,
 0x83c39be085f5e9c857ab5c83c6b941537818a871be5d9e7acca5e4120b9f8abd,
 0xea3a7fc00d1e491797f695c29d03ec378d373d52368bb3bbb7989cbc8b888319,
 0xc662dc169e4f221ccb9a93e3bc1806468cbcf94325a8ed53dc6229661161dcf7,
 0x85316b3fc06e3d040c81b77e9ba9ea5576cb6f8afac9d5ced67cc63621c93aaf,
 0xdda4c7bac733af6c08c5f4a86874d13d22967aa4e11eb08c15c91754e07be5d3,
 0xeff3442984e314ea880577be90ed330657191033a91cc70305bcb96c28d3596f,
 0xc00def875967064e4f255a4ffa914a47df15277e5c92cbece719ad873b65da65,
 0xc6ee3f2b60c4b7bc902386f6a3871cabfb535c76583913b0070612207da62485,
 0x817f79e69b459f37c23d0318c4752fa3d4ab1811bba1d8cc0606ea3c4197e947,
 0xcb3819d4ca362a23f124f441791059ed691e84c618d108b0b9a426172f4de52b,
 0x9828c5415afc19ede349aeeee4b1f62094db46c22c810eb11f92c70e67e05151,
 0xdc38cee95071116e88497ea06eca8ae45c9dd6a62298218b0389b123b4ab34cf,
 0x95d211c0bd2797eda16a5fb0d941e467586a76d431415638e9ebfc40592d1753,
 0x8eb725fc1ba17020b0d1419e5806c98bfc9b60f54b8ed2abd110f135e651eb69,
 0xf5418e29ab6ece58bf1b9d57f96ea505c3656a99425b603b85890a6fe0f63913,
 0xab8aff149f6bbeb7af273ec0521de4ddbe7065c6c7198a7ae0a7e7f57a9b72c7,
 0xef58131637b10a2bd667689ac94aaa7baae763ab0f266a365ab392c876fd839f,
 0x9691d3d2700651d72495329b873dc76bbc86abe3c89fe747c041a45fa5b74ac5,
 0xe7405181e37f7a42fe816a5310c0cb2a710f3f69d6ea391d6cf865b40872e995,
 0xcc0238367fab99b23ed2970ab51aefe34599345a31baa66b4f8f86a27d3170ff,
 0xaf71a7f90570010d4372d502256d990ad16aec2460cd7560f6b70627d037299f,
 0xa46da93e1a15bc23a2632be75c2ba83fb13b7cdd4e5e759cf2027d111afd30c1,
 0xb3c9ab51e40a6b6b4924cb869dca0e21bc7edfcc11b393b4c4b25a7374dc651f,
 0xc682be6bf09a2778f5be683e1632342bdced42bdad632809d1d44600db3228c3,
 0xf13e1ce17622d8b53a7b34aa55a77fb39b494df15278598381111bcf5f2e2117,
 0xd8ae28097dc97a06e89bfdc185de42dd4858c44678e05cc42ef8823264bb548f,
 0xced21146de6a6359312db8e1cbb2fa1aacad84c113301ed2b46bae419e2db6b1,
 0x9e8626dd6577535937c9abe5ae4e16ad365d4f14a04ccb0dd218831606d0c25d,
 0xa39e45a64c771fca5994624bfa57fce95151c925c0253835a6adb952caa52165,
 0x8995754cd747effdd14832b0370676ae4c0d26927d84151019a82b757b88632f,
 0xd898b96f200e1e1cba1274652a36fadd098f432f290f306d344135b3fb9085e1,
 0x8b559605b5c061a403626ce1f593805cd9df2f8640345ee9d3a2e69b67b533d9,
 0xbd9776c475be43a8265b32f2153da3af645ecddb38c91ae7e055a7defe4aaabb
]

# These are the 384-bit curve primes, used for benchmarking only. 
curves_384 = [0x8b8155582b73c5128774071b55d45bb8806ecc8aa2548cea5d04944aa121d1d93276c729e8b3a3a28af4754a77007529,
 0xa0ae20b70cc3b7ccd353e711be586504556ae72fb80453fcb6a78e2355d8582abc1fc2da80e708695657b1da399d270f,
 0xafe93650f964130bd7ef1d0a68bf20c546dc19174fd97c3992de165fc9bfa7c6707ff618300794b3e14370390b4f4a25,
 0x9d5dd35d690531f38edeea7de9d102090e628cf4c58403c01f7c0a0240dd735ab1c8e1718655fd5cf7fbc6e2eaf5ccc7,
 0xaa49d6a3721b36820e9fc25a535c773189bc11e15878e1be8adad6aac69c7b2ffb1d9139be92d969ffe8dae94c802f37,
 0xf4e74e32fea23c6c5f9e1eef84304384a5332666bfd0b98cb917be845c9dabb9322045c481d634dfbbfaf10fe71d11a3,
 0xb514b8eafe888743fb173f353b1c342115c99b166870344b7777cafe2699759d8f9af33d36a2f82692a83eb17be2e96f,
 0xaf31ffafe99376fd543e7f57e0bbb14427af460000215b04bff5ef7ffec381ac32c72326552bd983e695a4e166d03ed1,
 0xe3ac755a495ab9d8f48ba45383e72db50cc6a5a6ab8075154a23d8f12989283c0c7c327c3f79146ad0a3383c920be58f,
 0x9ddb27d81ab67c9fd9e220c28f8299bf65e72f6cb981ebb8f5c60580998ba5e1c8ae64d67bc8de3e0ea68b04a1409bb3,
 0xc0af1a1fbdeef663d2e08bed3f2e50f3a4131ff77ee6e66ced026e00c0489f4904512cfeda87dde5f5d1c2e5947b08e5,
 0xd18a7e8683724ab71865dfaaa62610775341344c705fa733db7234d41791e01e32f82d5c508ce293516f694df1ac188f,
 0xa77aab7829d664538459ad958aae01daea038be829590358e37035b039df52c080479c5a45695f7358b5dae0c77d663b,
 0xbb735b1631ea6d6c2844b95f6d5087917aaf1a48d70490f7a51e150366590b734f772e6550a3f8e3a29aab025e9d1437,
 0xfcc064564ccb05cda7e6ffa159c75b38f755b1cc637ac247b5eb6428e443add529362041dccd4c44c9680f5f632f772b,
 0xd7dc30a44a1dee27512cfb9aa220352f8d14ac093158a4dcc8a98adf816ea0ca3967794e800b02167944a1a32bd9c1a5,
 0x9f60c12bc3a3d953543a8777103f692dc2ae4b26e630f19a1561263b825c85cc1fec5e3b18829166f0e36c9dbb9aa8a3,
 0xdb44d1e32656d1ac71068219a4de0310754626f2721fcd137999f41acd39018b364cd4585b1d43abe20cdb31e05c27c7,
 0x97d4b6f6f781a69bf996b7b7e077982e074bbc187275ab71473acee7e58e4995c5800ddd267e680c315e607cfb096e75,
 0x890cb66e317d0650065597b2f8a92e05e0fae6bc66287ea095a7c50b9533476943a31c2bf51c5db4ee71ca7796a9ea6f,
 0xf584aa451acd4a246094a1106afa53d8e556ab65d36c0c341b96709e377f2cae398be312ddb5eef9a45e8fef810ce4fd,
 0x9e371bdae08ce955adc10ad2027abb98f694c84c50d1fa6976fc6ecadda54a767c7717cc369d738a3631b9a7f70000b3,
 0x9fa95a5fd33a96494cd889da6c5c831d1713891e92978b63786512193b97b7c8c269c6c91ca100100b96f6c29b86823d,
 0xec2b4c86921d61573cbf70ed9c24e6904e5140decbb6c23235e8d5aa6f15af80c433d89338fc211467df25304ea7ddd7,
 0xb7dde89be40bcf8082170119723cbed92ace84c65998de56af966ff4b7b26cbdbc0647c9d7ffc7a3f9ab278f354b5d79,
 0xe236079d8e0a1c0f12dce3b198d22f0aadd41f325a2e6e5729f26cf5ee12d49bc95b032a9b5d24255eb6cfcd6e987f95,
 0xb4aa28e4b8f5f041f75c27a6bf3de1cb14aee5a2f487356cd499fcb4bb2954d84a597e9c9aedcc42af834e3c41a6a79f,
 0xac0b9552fc2d31a0e9de81dc0310126857c38040550007c1078327f85372199e6174f86099bc0868907b0eb2ad09e3c7,
 0xa1b8f10d71b74846cfe6069d37561138616cf8cc511127fa7a49fdd27fcad6ef0b5a7e8ce5d6120fa8b1b0296f479a5b,
 0x8f283c61289ee80eed7d6d849ef2411181df03a4d77b51600679814bffbbe245c7d31be7945d1329858a9f86a393d3bb,
 0xaa0e4f30de1d985aa28b2e101824051b93d73264fb9fe99f28fbabcccba2f7751fb268aeea8b465b09e4c5f81de4891b,
 0x9afdfd022e6137afb1f3b4e571a58b742ecf0af860b4b60da490c2046bb8c8e33c733243ab73108b7c5978ad0bf09d01,
 0xfd83f167849543fbc792c70b44a8a7ddcfd42b24ca5f779baaab97b7377f42a02ded8f6c6e91426dfbea8d1ad843925f,
 0xda900ca6092dacbc0cfb9ad08a0c19abffc8be95b126dae2dad19d311248fcac694f4d2a9eb02cbcb92eac2a41a98aed,
 0x88e6b82a20ad19cfd522fac626d2e8706f2ae017038467135d19ca53138df15cdc192bd71427f11b42b3d4ce1a56bb2f,
 0x94839bcc184b1f636a6daee384a9afceb60b06c83fbda3aa09bf3ae56d58f819cf723473b3cb5948c19dabe3933c7edd,
 0xba6107054a8b25e26d27910bf52ebbffffb9fc294a29adc9744f12af9d1f326a55bb0ce2f60e806c90ab83b5115aeecf,
 0x9543de84fff27ab6d67dddebf78a9aaa065a5089e53c6d11817014821c03350305a9d96561daeb7eba30502d0a3735e3,
 0x81f4e72f0b5812267bb4a5842a3a5c1713777499f529caaf704f98e901d419ceb4d73008a860635d410402778b729b83,
 0xe1235dcf8ddba5ac1e663f85caf82e6ade60a8de37ca8c71a1781e67c1c449c73079708dd4eb8e77fa78f10dbfacc6df,
 0x8bee6e2aeba08ddc406a2d4f457866856ff848fefb1758ee98822a6fca7504b4b1d6dd38e3702f98fcbb4bc569dd5d4f,
 0xa34ac6753f0e51a1e2715c28f62f8503272fe16aba1b695b4196ebaceed23f4266289fd0c15b49e564e8b59a731756eb,
 0x93d445c07ba48bfdef191a1167ecfd25b75cbb9359d847686fa0edda08287156858159221737932bb79a43787328dbc3,
 0xd01d00add6c892c4f2b48e98d54c68679c4cd4f909dd08fa7d911d3976e8b1cd03574a0b34a4680ce716ab7829974b51,
 0xf12e6f4a19923094ea37b7fd03dadc748e2f5313f672c849a8f4e8bc7a4af0fc6ac7dd1b3535f261d4063354ff3e82ef,
 0xd639783b43a584acaff78d9204ef2aa20b0b1556f8c3622494f789bfcb43c5d58e76d2ccd8c1149d7f4cdd77eb8f064f,
 0xd4df15ac6e5c4c37c653adbd9109c3b6786cd8ec22c9cc161030e0d0414934fc3988d40db205ce6d9b3c98aa2b64b9f7,
 0xa228fc0e5b4ab9c416589dff543026228b29246f99f089b5b256dccfcc0e972b3257d9891b66d05f85b4619e45ea4595,
 0xd859459ca7e6d14b565e8122659fd4fb7420044d35aab627679ac513633ca885bed2ca63b960ebbdbd7d202ee46d813b,
 0xd8afa7dc450a6143f25aa23bcca3b22e523e1a316dbeaede642e85e6c42e687650f933f45c1afb43d55f677df50a39d1,
 0x83455bdbed1469e286c8994daf107241113641f0786d6abb43a1868670972ef23ae6e90ccd63c24ce56ab3cb3772d513,
 0x86cf5c336cf38c0f321ccbad86ae7854c92f8f4f93d0e5a34a0fc9ce8d2ea1182200c21ad9bd083c4888df07a9de9a51,
 0xf4310d265a5d0847a32bc353fd7fa92a500e2cde956fc3b830c93b31e01455fde56ac813d897aa3b25ec76c5ba0999a1,
 0xba3779b70bd3fc1c695d3d9630e54569c9553ed8941b38f71bf9c435f9fe4da661fd6928a37866540a8dcd168470fd2d,
 0xbe5b60a30ac698c1daf4f37ab04ec4cb27141135738862fc531a8c8a2b624b72c2a0bf7858aa603b069486a342750221,
 0xbd14f848896963a2b3a37413bf1a335ccb13b63f9e70fb29907505b89b32198b027fab0216071fc2f9ca69def08c8509,
 0xb4256620348bec6ea97c5c88057593a908632dd8c4b1dfcae28c64b7bfcb580faaddc261df7ebdba9d4468fdd423cff7,
 0xe1ab5f1eba81398687ac63b7ffc8f6b11cf35f5648aab1c0b6b9187d528ee872b6b25dd28d2a106663ec2414ef1a85e3,
 0x8a6466e394269f77747d04a97e20752f9e5fd2b13ca3b45ece5acdb9279978c81541bbdfaa42b39837a5bd4eca776751,
 0xf444c38d1ef1dfaf62ff9ff1da00e0c40a85d0497c9a7a9f89f24080b2266567b4c486624aa4012b73cf755504857c3b,
 0xca4d9f05f88d3d17abd952d1f085fa863780250b246080dcf41e9cafc86ca79b3a9f274590d6a2c95dc0fdf4eaffbcf5,
 0xcb1f8d872a001235f6d12af1ba11e13133863dbdfa7d982af13c1c9af087408099adf75be4e0ca33b440a348f47e940d,
 0xb199f5111c0609eb90774781a43e3402cb3d97458be048bb131e4ff5f0329d6e9d0e9c67d5bd1bf2fdb377717e7c7fb1,
 0xcb2dd39ef20f46ed8e538a7a3910a7d0b150dbc478a256068c326876541976d5b8d17009f2b28ebb8ea70cb7af05296b,
 0xa5fb3ddac7913be4569c01deffb96a7c3a7bd52dcdf2dd0a993572d8b301413ad7f699c07053bee6c76e0084717c6fd1,
 0x80c62c9e0c7519e13a0bbc77d3bf3e0958c70b139dc7401380892ca739d5e36398487dd016cd49079e2cb0bbf11b1b1f,
 0xedc3f9c165e711c90c5a5f481ef7e5ddd2023f1809fff6c1f28cebd67b9d9ed7b10e53bf09b39ef6e5e634537032dbf3,
 0xa855bc1c0ba37e656a0b3537c18f588da3eb0c44f57b2be60933ac39a607301e0314bebb510d5ffdb152e5e1c16466c3,
 0xcf81cd59f77e9da182ec802b9a2211d5f13bd71cdf4b2bbaeb0568de10fdfb955dcc6fb704034703f839caa9fb73e0a3,
 0xd97307688c165c081de7fb0cdc415ecb826de0fd3704479a805ebcba208313f2f42fb1aa782ef6e1eb8fb99599c2bdab,
 0xd0c23e89e2b26c111620f74f47710297b98993293970e2c241bc1ed74007c4d8e3abd32a2cbfbe9a5f0bf406745e675b,
 0xeb0ae857e4dc45b8d58513764608b942b2e5df7bca2b91c73b71b2df8379f817cafc7b585a5977af6e09e8892f54c99b,
 0xe883b5965ef5cf4a9907dd7acae159fbaab3e01cbc82cac4abb44e396e6a78da9c86b6f00f435940a73f59dadff8f28d,
 0xc3340d51ddc77c19896785e6b0eb017b2e2fa1a8e8273d28bb55f877c7fb45a5203fd6a934500b686bd75f19f8cff05b,
 0xa0cd850b572e533fefdc1ad5d227a43d7d9a863e0afe6940825c58965d11a7b6e076d9b5465f28072d018805ebd667df,
 0xbd2b401ab249d7e9fd8e6e7643690daf8475b979c940db15884f0d8d4fc480653e5cbf55b5ad3e9db108d389469797f3,
 0xcd2a813381d40e7469cc1a3195204829fdce511b70c6a4f4e4250a07fec2af43e5783fc831bb5dd5afb0b00bcb422359,
 0x80b652203864f138adc2ded1aaf92fcb326d34a2fdbbef75ab744392e6401614e941b2ebbf6fb57890be8288e2c42c5f,
 0x826cf9d2672e94c03901f2378d6bab060faf25a64dadfe69bbe5501c0dbdd7e177f582f4006f68c4eb0c2af617b5697f,
 0xa7e5b9cc0599f8792894ee227c3f58c4c27de00378d51d02b26ee495fb7e7a13f4671cbd74e25bf88d9b612b1299df5f,
 0xe268c62e973629631e905bd88b856192a7e0d12bbeb27df382c8066bd9c1f80825c753c37c01f9719454c1b6eaff95cd,
 0xa9557615ecc7ef500b33caef7ac9284f8655fcaf1ca48ef186a76d5b243ee68a0b0490633db49a66608344364542c855,
 0xd7ec28a5f984982645a3d745aee9e1480da66d4dc43de58fe19095518584f8a36a7d9087ff3e889a6ebddab231f304cf,
 0xbe4425bbe89975272db73b4d755bcdab93167d64205e36a96cfd13bf3e1e66ff501ecfc92455f641ab1d382d7ec4a0db,
 0xc132f9fc780360dc2915a25bc8ddb7824bb4ed02337f687fafa0e95a2347ce029c0eb2f7cc01623296340b6595839229,
 0x8a23769cb0b38290225396035672cd68d18505657a114e9522c1465e47aee20add3cd30ce52259cec68d0d1af342efc1,
 0xd1d6ef8c7b5795abd23df89d2a2e442a2a287b656ffa68bf7d337df772a596014f81f94e945c4381dee40bd0613340db,
 0xbc9a99d4aafe769f42cb07122c4f39a9ad1926857f6fdf55952faa174e81f3dc455ba87645b2e3264c5c219d715c35bd,
 0xfad575ce7f449880d65dac1c6d282f6a4dbfd648022785e344ef200da6e6e5fc5cfa8d648c965659692ab540484cc9a3,
 0x871c125dadf8e1b1f1757538b114fa659570a0ebbb3d68d3cf298159f16e1fd2d648df372035d5a5ac00d7a594057271,
 0xa66bb097b2aa812c0560d2ef284ba73435d936191b111bdf5618c506dd9bf1bcd204c7b8b44bd834d9d86149b8067541,
 0xcdd2acc2fda1648db2fb4c469e351099a1654f6e84d207e76ec09818f17c2beb4f3c82ee2044e767a2eea4aa3c191b77,
 0xf7ac7977e31e88c82b565720c00f93990f8f53f5dac5ec1dedfa74bf25c884446035fa0d2162cec74ae6c1143899b4a1,
 0xccaacb8bb417d2a58a27c2442ce95d3d531de4b80c486a3b459b6fc44c597ea8a00318b027f906c1abbeb60b24c29a31,
 0xec406f56b45d0ccb9f6b854e716c928ab97cd62a9b17d842f0e89286c1ea6e6e47c95d2d52e3d402bf82105d39a49fb7,
 0xe0df6e9d462fa9428852a90931a0e130dbaef8b62db90e6242f4d982f50aef2df3c14529623647e8169604653df7f26d,
 0xfeb507064021aab4dcd8c3fb5f5942beb2b37731cf785e687af11e2875e95b1e8f10b0e40826b6786e2338cc36667787,
 0xb2add07a12d9263f9743fb527e1c0ac62c5e2bc6da7057bf865743d5c1848bc725029d89f6c396921c67709901c4b859,
 0xac716926bbc7beddf13524005908ddd7df57d6de85612481647b306c4249da0b6c82fd6c52f24800ac0116cdcc6e02f5,
 0xb4839a9f3f00d0bb379f3a557454ba57921f50531194fd9d1cccbd2f92141fbf7da6f43cca1b9d809239648e0fc70f71]

# These are the curve primes for 521-bit curves, used for benchmarking only.
curves_521 = [0x189180316f959429feee408fdc45c416ebc5ce3d9fc2e988206a688a4c28e47b02bcb9fe7e93695d4f57966bf31592b7473a47591cce201bb5cf5f3006362bc72b1,
 0x173c7d29c7fa20f38f2dcbae1ce9b86b3a13ffc1371716746e4515b6145c899ae14d2f7b588e55f212bef02535a9005da59e0a40faed172fe2927b82e48ed465a0f,
 0x1cf643a351a3f80a3c6011bbf8f84f321b4f848b970037cdb9c99954221451090a09924bc851e9e3b9da9a794f53a3069076fe7827b2032f40cf3a514a9e3136701,
 0x11ca356b1a9925122c5c5ae900525188d048199de82979e95400de7a025ec24144062395d5e0ae9a50f6a4ef37b85426a8d44d652e4967e9ff853710335c15039b1,
 0x1928cbfb0e9e3463a5eaf736caa7c0cc1af16bceefa77f8f68d7d24f852ec5cecb9741bf5fcf15c9c47d698fc33729cb317f580a8eba131fc996e73a80b4168afb1,
 0x1a5d02c00de0d73353f62a184f4b21fd952a98d4089b6f256f5f7c191e161fda928ac7dfee61dc2442dd95c7d315fb6e3b8d38341617f50d9649a9a711885b03c81,
 0x1d4bd9f4dcfbd59ea9a2138f75ebf2b79ec7da59da7f864a30413249e6076c3b3f9f00271aa33e81d824991d8093733245a172a0a205f634f03403ef7bf7cd62bf7,
 0x110cdcdc4695683b79b7cb76ab402e8423c8277fc727d4f33acd65d74f551d6b25840eddfe51c04aed0db521d05fd4dfd9e60b3c9d48bf12da2f45e7791d0505e71,
 0x171e7b6b095c670071b0106364ee444a9a04bf2439f3fd61d4f137e751b93034df937ba6b3316ac18fe1cd0b6973b8b9db4ed40330f03c1ad21610f2264d09a13a5,
 0x1cb3091be0daece2b4340b3b72848c2369aac755666d87efa57513ef0209bc0a3cf7a273678ba399f31a7ffbd2f4d83f328cc6fcd736e58ee0053d6065147a26205,
 0x1e217e7b8512a6b1a2aec001f94af5472160d38213f6796db00914ba29799b3d3412cfa391576540ce0b6a177361cf7b375a0c81a95c3b188ca4f485cef88487c39,
 0x1167eddc83d54f60e38cb7354e45e0c0ff52d18881591103c845a467b2943f9590c3a759cd5cae48714a4580763eac42e006abe5c26272a4d77348cf234c691b6db,
 0x1964237473ca138ac21ecb86eb96002b56a4ce5ae368072d2e7acb2697a4af58f3a69302674132e0e806e2dd40d7a31581e24ee369ac5031aa93ffe07a3faaf8eed,
 0x16a91679a60789539536d6987f5776af30dd27bdc0ae724bc465c4d102b1e1b5bc3644a892939fc6970ecf8974c796f79abe4b370d014c562a327c53081e3fcd9ef,
 0x1f902282111803da86b85ca354df3307f88bb9851c1f640c63f24e3e737d667ea915fd2a7028625655de090a2f694350a51c9813a79b95ea3553f290e631e0c980d,
 0x1c873028fdfea17a4075ef52e8631d54330f73f067576306d2b4ea8b902ea09de55b9da6a7a30c10b72dd9df63b4ae9cb901f4d89218ccd07da81d1871c7a42a5b7,
 0x1c4d436067de2d572cd62fe3d0bdbefee333ee51d9e33c7cf87896cf0163f7ee371855c7363dd51f621c4f43a91840cca71205b76788f80ba7bd2f5b4b8bce92c0b,
 0x169e772ee9fb9d275bc5ea1730a5bc2e951efa0b18f086d5602acbb5c3452394d9083b63eea35477c45ee6ba859bc4b43c88c858e3ccf135195c38c6f81d5e6291b,
 0x1b249d54350acc9daa0a5a3494e651619b4b9f3d6cde62c525dcbb539c91841476ba38e5a66811a92a8012b15eed98a9f9051f876e331d63e0e72eb07c785024de3,
 0x161ac2b0fd3e0d1e7f74419d877d40e3af309c213378f8441f62a6ea860172ffa4bb50101935d49dcb593094f56856d649518dcb5dd0fd46057d024d500ce588aff,
 0x10a7241d317bce326413856b1c9ac232d61a378305188903eae8e950779581af026d4b17a5b0e5725fdca69b2fa1b9b66c6d111ff82efb3e647ce0160b0e4518557,
 0x16f551f57357bd477c92a74b3c13408da838f3e312d85fa51a702dd8aff3330ce361b0ba9bd2ecfe7e9870b66c2ef8051c75f5a30627b7d88d396895358a433c565,
 0x13a7482fb452b9ebc1667be9f9f53492c447bbf0ef27ce0f5bc1406a51fa658b848e60c39d83776f7594424d8912f271e6ffe25f6de3d15b3fcef4251239a1a98f5,
 0x14f50965bbd9961ffc8ac41bda72cdd11616cb19215a40ed791eadf2e819db5184454a902bf830012fdb507d1af7ecf7b0674e80a22b9a3b4d7ce3a1d592623fa37,
 0x13adf718c410711c59a7979f1b48cbb14f815c5702a97a10481ca53623aca0f729a6212d22243915025352bf7e8937366acd32a09910d19c577b090087966e8fa79,
 0x107500fe7b238681fe6e085a1620858602836f219be2ca01627cb1eb14edffdc047cedd5d6e53d93d05773f2c2ebb1c06e53e60c9631451a7c60fa198349ada487b,
 0x1290b338600324f06ac64869ef64b968f90680d787c4b8008a9db4692b573ee422763eef939d1640ce62809f7a489b28b37f62fd8fbfd7e12daaa97f32563c26d39,
 0x148c47aa57fd93a759e6fb365e9537a54aa6c4ae6c914a7b985579dcda40bbeb7f86052583f83382a022cc74e246502c95bb8da37bd4caf7355f87a38673a316da1,
 0x10f73b96e982a8f66379042f7bde689b8993e7d1db9b194d4dbf6b02215447f415230c6e431cc5df348e1663ca9b59292fe52532b6c6c0d92791dcc1bb8e24e7699,
 0x1b022c34f1d20e2a5e9e3474dfb085951fa02aeddd0c8ab9eae8c4d8ef6f8ce208e5feca94c1d744d2b438ecc89172d7b332f0db6aa4e9b64890f6d249e5fcdc63f,
 0x1189d556ec63e67b4a271038b63b373fabefb78fdd636b4ead35e27b8cd8e4e45937b535a95d9de754124b5f622658ab9e9b16f2d3e6f5375a16be9a317e5d61a25,
 0x1cd44fee9cee4c05910a2cfed474d8cc03ce959e4d7bd5d86c46cdcf779ef7ef4beec8913e47df79deed2edc769f665e96d480470ca2740ef4902aae7a04b51270d,
 0x1480d0a042fe257a59ba55967bfb6ade3884b0840ff9f243ba8a88424eedc4703a01c2fccec178a097ccf57f5778431d341cb5c920f43fb83f98d75e79bcfb8d1fb,
 0x1c8fef091006b4394d9aebb4efd9f4e5637c64ae2e58fdd8b976c3507a64924c6bf413ea5733f8525a5f00f554f60754bfa3ac60bcab2789af9dc97c7e1f33ac395,
 0x1ecd1b08041358fb5bc9395e786e35408ecf838d55f66226ea72ed5feb67a485ff51df3f60d5a1027e39709b87426d0b1dbaf9f19f1e76b2c2bb20eb02944e50b4b,
 0x1f821d5299f2b4ad862d612dedebd0c3ec79bb362b1444454402fe29a8934ce1481264849a95d43b2fe4c9cdb741fab2a6c3e7070ac2a7bb305dd23da62c47b73d5,
 0x1f7309ceae9116a0ea445bae98e949abb84a19b5fe3f57e42c5aa54242b752c74b0510e7652c130fd06c8e842329b05b17784bf2e4373962ec4158cb45a2b60c5f9,
 0x1af755123098e52c50f12f69837c1617d9abfb332ac69eedad26502d9e72a423950c407933fcfb1a383164825593a322427213dc521b9da10ae5638955a16a549bb,
 0x13c7a17f2e916aacf53f595d8821cfcb6a91d28f3427a288023cdcfea5c21231245a276d9ff5b2c02a72d69fbee56b3ee7ed3b50933c7669fb1005444106e261b8d,
 0x1775affd7efbda42885f7f8a886cd2b2567f3475f240db2d3f9972b577dcf5111a678f4dcefd804b878c327cce4554a099fe3438f7154cef1612ecc9f130ea38de3,
 0x17c613d2af8d970ca584806e0d092a0495be569c82676c961e0a27430f3f65bcd368de8400b789685c3968c1d1164a507a03f62d3e42808cad2d584922c30225e6d,
 0x17e0a8369b07144d905a08e769dc69fa34f0d306eb3baf875008e799821731d2c2e7782906ccfdeb0acae0b10f9f7d967d1dbb7d378b3e5316bfe8bdb51d26bb5cb,
 0x186ffe449f8d1db51eb0ef213aaaac9c90d85fdb0162a5356ae7bae8d8dda514064cd20b07675f0ab9e7ce5ed028d896986f44fae93b3a32b52013b4582cd007ea1,
 0x114d93a97b841c5cca9aab7b60f87c6d627e9932e408e113257208ddae17ae16cfe5ec50adac186c5ced72e8348826c03ba858223aca29aa422ad276c5c43d50fb1,
 0x1bab32ac84da804a7f3ae6fe7178663b0d7a29fc82a5fbe9bbcb00d106c2ffa186500d1972dcfe58f09b103bcfe063f3610a44c1bd39ccc6f0492e0cd15e255e99f,
 0x14e0349cfec567c806da0877533c458cf13ff8247080098200e5cba22d1b7105f0da9ba13df50e4c193acb739ccb336b8f48ae5b5170c2c4ba78373aa914d8f11a7,
 0x127459923c318eacf0c5e310215eb2fe14b7e28eb46f5a016c816e22703e79a92528b5d657fed76118d03458ced7561492822a342b6512f35d9c69d8b53b270d995,
 0x11d210d49e8f6ef408f22f7182f9e0d6e8a8baa95d55692c9f908c5c762e3cb8f3fc4dfb478b6c9c8df764782178bd874c4775308b62d84a9bc6440e87bb5316df3,
 0x1d9436faeef5ff5738a301f6dad5215e5bc1a4e08e0d1c3eec0a5ed7cde296a8662a64f0d8312a540c7ceaa94507700b1f6702f98e9aafb755565a1d339c85b4973,
 0x15c8005cff5b7eb4ab764dbd2cc834046a638f0daed064a28bb1f10061d96fd50662390c4e19916c4a1ffd549e7935360450f10f0db1606fe113483c4c9a72c4b29,
 0x11975a833270ec0d734c120f7d870bae3d23ac31b8a98f89a7cf8357b76328b76a429718b9347e1e062f91d931aa26e80ef4bb97b6bcceb7fabebf15c496fe55a4b,
 0x110f7d5afcbf01730e36d90c125b24b14d0dd1500cde8255d01e5b23225844bbf014522ef5335cc27219dd4f6e4a21c7533ffc57b1e5079afd41abc474ff7ce94a3,
 0x10ebfad0c3d319f96ff107e39157c541ff1e21f431d8a26d79f769d4867ad7a7ddfbf38b90bdcbd70f170f09d81da02c18f3248819566ff9e57e03ed4635032205b,
 0x1e6bc819dd09a0d7e916294061ca6796a54571dc7d715d1f44cb43f1c6412007315ecd127e8d41badbddd9a90cb0d5fb6485bcdc05eb08990616d976a9302f06ed9,
 0x162db91c20ba34bc83c416c401543a6278bc1e5cb66b2e594b39a188e60e1942d768b5091ff83d4942a5983e5b4b4d7463d7f7e54696b48f6554e47abd1303a5063,
 0x14dd890ada72816a27597480f31bcdd2826e6a363f4dda363f088996a56b1f021055e688f6f5765afbae08b7bafa8bc401d074b6d3e2de83c3c8d1aea76d47f650f,
 0x1e6bb9a6020fc5ebb7337cb4cc89773df5bf9b90be9ade04cc58cf39e8bf85a741229b7d28a9e93f7c1d3117e4f04171164c47cd24891b50bdf6feefa7b816ae6fd,
 0x1e8f8cbe0ce944f395580bb76be7267b890f214bc22e3d611284168d8d47d9d02f0b67b8da5a34b00fb4590e33ef05d63d277b74e15c20ab519bfa779a35e1658e9,
 0x1843070c8aa18df7c63c91c1fda79f95322dfaf07771255d63d310726e1e88d34d0d4b0f6cf0ed82d33e183776421184a34bb0a6ef96fabeef114aadbc0b44cc567,
 0x1968386d7aa1b63d8f4927e8c5031c4a1d130b72e0f7c6011327e871452815bf03f7e1d8e62c24755325a7bf841c5d04bad2c33978d2b086582bb002b32e8c72783,
 0x18602f32ecd557d20473080d10512f6aad074550fad12cc53b27be45b213d6520ab23895d2ea0c81b8d919081a6fe5824c9e0098afd2440302226a6f50dc3956f05,
 0x1d747fe1c0b16a1d2a64e606b9641b523ccc47576b5e5add8248d2307657c2340ca7fa61f79de440a4f92654dda7d56f445cd68eecdde194df19bd9d80937736f13,
 0x13f0da98fa2e03a65b2a520681d7d6f1ab4ee43b40bf8473905ad806aa712f11b8ffb3bbe0cc98db6ecc412a8371fc4d5f05c20a334069cb3a8357e19f3959171e7,
 0x1abe3cb24800809979fc98f5caeb17476807c534f5c218f99ce0f3da51c81955e96648a9552c59ac3038aec464b012f89924fbc298889d802a4a3c1de8ff7daef01,
 0x177d0ed5bc8b952c518783d519e79e06071569d4354749fdd6e132d282f3677370570bd9aaac0d62ca0da385cfef88b88bc09e69ebc2a53fcd623b7a1613ddcbb2b,
 0x116550242d4c82e7b1e86b4eac4a9b24838d0992f1994979709f3c9d6d05873c38eb3b3182864b7c35c5a529a84962ce5d3db7de90b75827a21c04275aa3ba25183,
 0x16821722b43210e3f5827fb0a1bed7990d29111ca3b5b92bbeaed9e3c38ab31aed71c0e34fbbe478bacd01b4ce7619149873b01de32ba8fd9b9fc1d7bbf367ec66b,
 0x10481343a88992914b5456ad1348f12e843df954557708c8599f7339115f0618058c962aed52c9edcb66ad60d518bd7d47187e8051fe5cfebeec4c98002c66c4aeb,
 0x10835e87a339bb7f102e86e1c202c9a82526a401d7cd46f5fa1edc91ce58979b983bd7acbd4d2abc5786bac1db2161d6113701b8445374483876644dc557b24ce01,
 0x1763888d572cf6157da3515e32097193cb04402b91c01fb65f1c0546d437efccf6812f575724b84224595736f2da5e717727356b9ad22cd0443b9d56c7c12fca3db,
 0x10c299ba3c49aa21d24c58b2e63a8bb6c0d4c759d2a36ba701200394409c042c460abc283236a2405c69f83906a71586fa68e6246dbe0dc01ebf0aa2ed599d3aaad,
 0x10cd0cfd156d334c02d5a378039b25a62fb937a5e179b1a8bc2ea909564854192c60d5da06155c28c961fd69983c57841c5d35cdc150c4124fd87ebffae5c139663,
 0x17773871f90d6c236dddc2e59cc5050c4ccd85bf9e8d48c73c215aeb26459c6ea636ffdebfbdeb52b355fea066da716b32c87340e4b54633f13c196cb8a66e72d83,
 0x1082fb33f28f3da053b1a58a264983274a8c3f2bda466ddd0a67ff4cea5bf5b9dedd698ac3a4b77215830da7f52622dc4bca62316d170be2b40e33234f97d6bc73b,
 0x145128c0654a0d750a583a975bb0e34dc57e272ca5dd6de14b2786593708e1021dee529ba2298b7eb9eb6e30e50c63e681507fcc65545e4deed2d9cff3318fbb9af,
 0x10edafc879c30373b13b23deceb262ca3152b6ee03416c0cb9a112005546672d235fad387af78aeb2a6e921c17467ebbb2d0fb9b8e92b7d33943991571fb6ed05ef,
 0x1b6aaa351a4ffb88eca8dc4e4c03cbe14c0028a3b947347420be6d294df45d2d3aadc701471252dd3b041ac04642e97aded68adf2bd9f4687250dd610e519881121,
 0x193da9930012282c03d8a5f3498834745d5461e5acfd9fac7af6c57b5babc362997991e2cf3fb30ec373959e615828a9f52943c09e1774a853d725d3d3d4447cda9,
 0x16c6f077dbbc20bf3c54016016ee463d35fc3361a41060daf1ce44bb245741d935c130851c3d49ca0504f8edfc88e1194ecf17ab7ace3efb8ed6fde8aa9886f20ff,
 0x19aec1067fc681a15c0800e7984b0370d81281f188c6c4b0e76375a44c192f859392b4225f8f9d672b7b1e128170e0ec36a849f5b7bb6e0065df87eb92047c18e09,
 0x1b470300c439ba3f8efe1c1ba0926bcd352f43524482ad48fe5b87b01e4eee346f3d35a4835eada62b857411e962779630e8304cedba263edb373456e24c3e678b7,
 0x17dc6365060e41a3ef7a8a3c96c29da82656158de3305e18a0487e0f7acf68a672204172bfa98cce3bdf0e643e93efd3e8b0726b4d4aaf649dbd23ce1e2d4df8691,
 0x110f7db6228976d3b6972214eee5bc664655b052a3a1cc9eb504a79f35fc24ef62e5e9805f0b0b350dfda35614d56f667cdafeb353dad443a06322c379830eeec65,
 0x147672130615f4c1c88693043bf0accd5bd0dc69bd05ace0b3ad83b3787b6591716548d2867a795ef12c2d045f92dfbef1f4707b3ebe20c2382421c7c83fea5be5b,
 0x1a6ec0b1dacd25776d2864429cf9037c065f1ec75f431a678f4d79b52257f7ab2e3460f1aedd4a1f7d27fa3ab7dd883c258e30f7dbcbebcc01f8d504cbbfde78a9f,
 0x1afdca3c20950ba374b64b1d4e4ca78e3c1a3a9aa1925d46acc45cd2f202e0fdb16610e2df994f7a8ddf03ab646bbd04f32cfb0067c76996942b4801c5a3ddf801d,
 0x1a5fee8a7c1e4fcbdf21944a0336b8bc2311358dab5b5234585d6c5023b061a5e5d96a948c2eda45cc43a9f89a419dd3f0f3f2b3109873a65e03c125fc1cf14e741,
 0x1e88fc24a8614ce3cc7b5943caf0e9d22cd97a067f3029a6a8b2da9cc605f409e6caa4f3d082b0e502731d0177937fbad06b25e331fd9e2abedfa6aefd1941082d3,
 0x178150b78319f9268493c8a6093e890aa637cb918acaf54bdf01cebf2dc418d21b72a158d6245033cc7489bed06033afc53772af03402ca74cafa5df4037f192515,
 0x1289d48923973ea24a51fa6e7f480489550a1e22afa1cf9b291fac9b22be49fffc03c3129f9718eeb9e3225b6f215ea58f5501e32450715bea41643f3bcbeb88db7,
 0x118e83449844ec92b3cc3241d03ef98004d79b92d7817a48aecb62cddc0a241944b890279430bc5fc759e94635dc2fed20e43cbb6305c1c49b4b25d0b5c8696b1d1,
 0x1b07e4319ab75ab1035a4afac64f9b53834c70453bde28aaf5804de6d5530414000f1d28d33b7d15090d89533183f08a0d5b3fd901d77b4bc1c335333087e934edd,
 0x134bbf9a587055e93902ff90b3337f2c48d867ef19ea0d1574065a0348cf45236be428097f0ab3e355e4b0cc19017fc8ecf28db3b23e432de2b152ac99de37e061b,
 0x15386e93451d2497780fd22ac3e9c206894e2d486a3bd1139a21db699227055477ddb85ea83e7c680eb41fa1991a73e46ff6313c1af5973a36b247fe7b95e5f1f69,
 0x177c9a3b4311e92fc1493cceb92c4639e34e4e800ec2d40e969d02564a8c77491adb88ecfe448c9005761b8c997043308d6ecf3507450cdeeb3e2ba57b5824c1ceb,
 0x16c7f260ccc5224c47d82f5b0ced9fbec1b8c227c4d1cac3504e023c5af8da6760315e2656d332e2c8f79ea58dc148ccb38f8f01d37caf89e71170447701382873b,
 0x1b7bd86b463fc92d7ed875ab498e722542c88326313b8f220eef0e07a96c4ac30721a40fe358fd83cae6647297e028aa1c0cfd36ab8bd5c957a16b3b1ace9a9f5f7,
 0x18522c1884a2aed67dbae51c193363516a50426753a8f7adacf723b8cf0141e0d752578a0d7530ab5fec33e111fbfb746ad73a97e57808c7463952dcf224e5ab849,
 0x14bc97a059b7e448deef3542c6f844b5d73206a506b55a80109db9e7dcd2fd460e815208c7d7d1f4735865198927ba3cac3bb834623029eec90773ca86a275ce493,
 0x1889d8d9e3b6b984e4f830c9cb80f56b33ec235f8a1a620d41cc1595e71db5402983575f54d3662d5e78155f42d4457eabec70c7eb079174af003efa4cfe475a489]

def cornacchia(d, m):
    Q = gp.Qfb(1,0,d)
    sol = list(Q.qfbsolve(m))
    if len(sol) == 0:
        return None
    return [ZZ(sol[0]), ZZ(sol[1])]

def find_curve_of_order(n):
    r = 0
    logn = int(log(n,2).n())
    while True:
        S = [ legendre_symbol(-1, p)*p for p in prime_range(max(3,r*logn), (r+1)*logn) if legendre_symbol(n, p) == 1]
        for i in range(1, len(S)):
            for L in combinations(S, i):
                D = prod(L) # The discriminant
                if D % 8 != 5 or D >= (r*logn)^2:
                    continue
                solution = cornacchia(-D, 4*n)
                if solution == None:
                    continue
                x = solution[0]
                if is_prime(n+1+x):
                    p = n+1+x
                elif is_prime(n+1-x):
                    p = n+1-x
                else:
                    continue
                # The usual CM method
                P = hilbert_class_polynomial(D)
                roots = P.roots(ring=GF(p))
                if len(roots) > 0:
                    E = EllipticCurve_from_j(roots[0][0]).change_ring(GF(p))
                    if E.order() == n:
                        return E
                    else:
                        return E.quadratic_twist()
        r += 1

def find_order(characteristic: int, loud: bool):
    """
    find_order. Helper function for finding a curve of order `characteristic`.

    :param characteristic: the desired order of the curve that is found.
    :param loud: true if the status and curves should be printed, false otherwise.
    :return the time taken (in seconds) to find the curve.
    """
    if loud == True: 
       print("Finding order: ")

    start = timer()
    E = find_curve_of_order(characteristic)
    end = timer()
    if E.order() == characteristic:
        if loud == True:
            print(E)
            print("Discriminant: %x" % E.discriminant())
            print("J invariant: %x" % E.j_invariant())
    else:
        print("Error: could not find curve of characteristic %d" % characteristic)
    return end - start


@begin.subcommand #noqa
@begin.convert(loud = bool)
def find_curves(loud: "True if you want the curves to be printed, false otherwise" = True):
   """ 
   find_curves. This function returns the T curves for each of the interesting NIST curves, 
   along with the time it took to found them.
   """
   
   k256_time = find_order(SECP256K1_FIELD_CHARACTERISTIC, loud)
   p256_time = find_order(SECP256R1_FIELD_CHARACTERISTIC, loud)
   p384_time = find_order(SECP384R1_FIELD_CHARACTERISTIC, loud)
   p521_time = find_order(SECP521R1_FIELD_CHARACTERISTIC, loud)
   print("Time for K256(s): %f, P256(s): %f, P384(s): %f, P521(s): %f" % (k256_time, p256_time, p384_time, p521_time))


def get_curves(size: int):
    assert size == 256 or size == 384 or size == 521

    if size == 256:
        return curves_256
    elif size == 384:
        return curves_384
    else:
        return curves_521

@begin.subcommand #noqa
@begin.convert(size = int)
def bench(size: "the size of the curve's modulus. Valid values are 256, 384 and 521" = 256):
    """
    bench. This function repeats the curve generation procedure across 100 different curves of 
    bit size `size` and outputs the average time taken to find the curve.
    """
    
    assert size == 256 or size == 384 or size == 521
    curves = get_curves(size)
    print("Running benchmarks for %d-bit curves" % (size))
    times = [find_order(curve, False) for curve in curves]
    print("Average time taken for %d-bit curves (s): %f" % (size, sum(times)/len(times)))
    

@begin.start
def run():
    pass